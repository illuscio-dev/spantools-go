# Setup go
steps:

- script: |
    wget "https://dl.google.com/go/go1.13.5.linux-amd64.tar.gz" --output-document "$(Agent.BuildDirectory)/go1.13.5.linux-amd64.tar.gz"
    tar -C '$(Agent.BuildDirectory)' -xzf "$(Agent.BuildDirectory)/go1.12.3.tar.gz"
  displayName: 'Install Go 1.13.5'

- script: |
    mkdir -p '$(GOBIN)'
    shopt -s extglob
    shopt -s dotglob
    echo '##vso[task.prependpath]$(GOBIN)'
    echo '##vso[task.prependpath]$(GOROOT)/bin'
  displayName: 'Set up the Go workspace'

- script: go version
  displayName: 'Print go version'

- script: go env
  displayName: 'Print go env'

- script: |
    go get -u github.com/illuscio-dev/docmodule-go
    go get -u golang.org/x/tools/cmd/godoc
    go get -u github.com/mgechev/revive
    go get -u github.com/jstemmer/go-junit-report
  displayName: 'Go get CLI tools'
  workingDirectory: /home

- script: go get -v -t -d ./...
  displayName: 'Go get dependencies'