# Setup Python
steps:

- task: UsePythonVersion@0
  inputs:
    versionSpec: $(pythonVersion)
    architecture: 'x64'

# Download Secure File
# Download a secure file to a temporary location on the build or release agent
- task: DownloadSecureFile@1
  name: pipConf
  inputs:
    secureFile: pip.conf
  displayName: 'download pip.conf'

# Download Secure File
# Download a secure file to a temporary location on the build or release agent
- task: DownloadSecureFile@1
  name: pypirc
  inputs:
    secureFile: .pypirc
  displayName: 'download .pypirc'

- script: |
    mkdir -p ~/.config/pip
    mv $(pipConf.secureFilePath)/pip.conf ~/.config/pip/pip.conf
    mv $(pypirc.secureFilePath)/.pypirc ~/.pypirc
  displayName: 'move pip credentials'

- script: |
    python -m pip install --upgrade pip
    pip install --upgrade setuptools
  displayName: 'Upgrade pip and setuptools'

- script: pip install --no-cache-dir -e .[build,doc]
  displayName: 'Install python dependencies'
